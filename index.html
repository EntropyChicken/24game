<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Play 24 Game online. Solve math puzzles by combining numbers with arithmetic operations to make 24. Fun, fast, free, and ad free!">
    
    <title>Make 24</title>
    <link rel="icon" href="assets/favicon.png" type="image/png">
    
    <link rel="manifest" href="manifest.json">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="apple-touch-icon" href="assets/icon-550.png">

    <link rel="stylesheet" type="text/css" href="style.css">

    <script src="libraries/p5.min.js"></script>
    <script src="libraries/p5.sound.min.js"></script>

    <script>
      if ("serviceWorker" in navigator) {
        navigator.serviceWorker.register("serviceWorker.js")
          .then(() => console.log ("Service Worker registered"))
          .catch(err => console.error("SW registration failed:", err));

        // reload the page when a new service worker takes over
        navigator.serviceWorker.addEventListener("controllerchange", () => {
          console.log ("New service worker activated. Reloading page...");
          location.reload();
        });
      }
    </script>
  </head>

    <body>
    <!-- Firebase SDKs - use the modular approach -->
    <!-- This script MUST come before any of your game scripts that use Firebase -->
    <script type="module">
      import { initializeApp } from "https://www.gstatic.com/firebasejs/12.1.0/firebase-app.js";
      // IMPORTANT CHANGE HERE: Import 'increment' directly from 'firebase-firestore.js'
      import { getFirestore, collection, doc, getDoc, setDoc, increment } from "https://www.gstatic.com/firebasejs/12.1.0/firebase-firestore.js";
      import { getAnalytics } from "https://www.gstatic.com/firebasejs/12.1.0/firebase-analytics.js";

      const firebaseConfig = {
        apiKey: "AIzaSyCDv8aTBxn5lfQQSA9kP5JQlJ-NNszJJRM",
        authDomain: "make24-1e644.firebaseapp.com",
        projectId: "make24-1e644",
        storageBucket: "make24-1e644.firebasestorage.app",
        messagingSenderId: "770585457003",
        appId: "1:770585457003:web:9145d890d5b59403559c2e",
        measurementId: "G-6CFVM2YNKE"
      };

      const app = initializeApp(firebaseConfig);
      const analytics = getAnalytics(app);

      // Create a single object to hold all Firebase-related globals
      window.firebaseAppReady = {
        db: getFirestore(app),
        // Now 'increment' is directly available here
        increment: increment, 
        collection: collection, 
        doc: doc,
        getDoc: getDoc,
        setDoc: setDoc,
        isReady: true 
      };

      document.dispatchEvent(new Event('firebase_initialized'));

    </script>

    <!-- Your P5.js and game-specific JavaScript files -->
    <script src="js/complex.js"></script>
    <script src="js/rational.js"></script>
    <script src="js/operation.js"></script>
    <script src="js/bubble.js"></script>
    <script src="js/bubbleBox.js"></script>
    <script src="js/titleScreen.js"></script>
    <script src="js/sequence.js"></script>
    <script src="js/button.js"></script>
    <script src="js/level.js"></script>
    <script src="js/duel.js"></script>
    <script src="sketch.js"></script>

    <script data-goatcounter="https://make24.goatcounter.com/count"
      async src="//gc.zgo.at/count.js"></script>
  </body>

</html>
